{"version":3,"sources":["fulcro/client/localized_dom_common.cljc"],"mappings":"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","names":["s","clojure.string/replace","k","cljs.core/re-seq","cljs.core/name","fulcro.client.localized-dom-common/parse","tokens","get-tokens","id","p1__56903#","cljs.core.filter.cljs$core$IFn$_invoke$arity$2","cljs.core/re-matches","cljs.core/first","classes","p1__56904#","global-classes","cljs.core.into.cljs$core$IFn$_invoke$arity$3","cljs.core.comp.cljs$core$IFn$_invoke$arity$2","p1__56905#","cljs.core.filter.cljs$core$IFn$_invoke$arity$1","cljs.core.map.cljs$core$IFn$_invoke$arity$1","sanitized-id","remove-separators","cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2","G__56908","cljs.core.into.cljs$core$IFn$_invoke$arity$2","cljs.core.keep.cljs$core$IFn$_invoke$arity$2","cljs.core.assoc.cljs$core$IFn$_invoke$arity$3","fulcro.client.localized-dom-common/combined-classes","classes-seq","classes-str","clojure.string.join.cljs$core$IFn$_invoke$arity$2","cljs.core/seq","cljs.core.conj.cljs$core$IFn$_invoke$arity$2","p","nm","dflt","cljs.core/map?","cljs.core.get.cljs$core$IFn$_invoke$arity$3","cljs.core/object?","G__56930","G__56931","G__56932","goog.object/get","v","G__56934","G__56935","G__56936","goog.object/set","cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2","G__56942","G__56943","goog.object/remove","fulcro.client.localized-dom-common/fold-in-classes","props","component","temp__5718__auto__","extra-classes","pget","old-classes","pdissoc","clz","fulcro.client.primitives/react-type","new-classes","cljs.core.map.cljs$core$IFn$_invoke$arity$2","c","G__56950","clojure.string/starts-with?","G__56953","G__56954","fulcro-css.css/local-class","strip-prefix","passoc","fulcro.client.localized-dom-common/add-kwprops-to-props","kw","map__56962","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","cljs.core/vec","cljs.core.concat.cljs$core$IFn$_invoke$arity$2","fulcro.client.primitives/*parent*","p1__56957#","G__56967","G__56968","goog.object/clone","existing-classes","G__56973","G__56974","G__56975","G__56977","or__4131__auto__"],"sourcesContent":["(ns fulcro.client.localized-dom-common\n  (:refer-clojure :exclude [map meta time set symbol filter])\n  (:require\n    fulcro-css.css\n    #?(:clj [cljs.tagged-literals :refer [->JSValue]])\n    #?@(:cljs [[cljsjs.react]\n               [cljsjs.react.dom]\n               [goog.object :as gobj]])\n            [fulcro.client.primitives :as prim]\n            [clojure.string :as str]))\n\n\n(letfn [(remove-separators [s] (when s (str/replace s #\"^[.#$]\" \"\")))\n        (get-tokens [k] (re-seq #\"[#.$]?[^#.$]+\" (name k)))]\n  (defn- parse\n    \"Parse CSS shorthand keyword and return map of id/classes.\n\n    (parse :.klass3#some-id.klass1.klass2)\n    => {:id        \\\"some-id\\\"\n        :classes [\\\"klass3\\\" \\\"klass1\\\" \\\"klass2\\\"]}\"\n    [k]\n    (if k\n      (let [tokens         (get-tokens k)\n            id             (->> tokens (clojure.core/filter #(re-matches #\"^#.*\" %)) first)\n            classes        (->> tokens (clojure.core/filter #(re-matches #\"^\\..*\" %)))\n            global-classes (into []\n                             (comp\n                               (clojure.core/filter #(re-matches #\"^[$].*\" %))\n                               (clojure.core/map (fn [k] (-> k\n                                                           name\n                                                           (str/replace \"$\" \"\")))))\n                             tokens)\n            sanitized-id   (remove-separators id)]\n        (when-not (re-matches #\"^(\\.[^.#$]+|#[^.#$]+|[$][^.#$]+)+$\" (name k))\n          (throw (ex-info \"Invalid style keyword. It contains something other than classnames and IDs.\" {})))\n        (cond-> {:global-classes global-classes\n                 :classes        (into [] (keep remove-separators classes))}\n          sanitized-id (assoc :id sanitized-id)))\n      {})))\n\n(defn- combined-classes\n  \"Takes a sequence of classname strings and a string with existing classes. Returns a string of these properly joined.\n\n  classes-str can be nil or and empty string, and classes-seq can be nil or empty.\"\n  [classes-seq classes-str]\n  (str/join \" \" (if (seq classes-str) (conj classes-seq classes-str) classes-seq)))\n\n(letfn [(pget [p nm dflt] (cond\n                            #?@(:clj [(instance? cljs.tagged_literals.JSValue p) (get-in p [:val nm] dflt)])\n                            (map? p) (get p nm dflt)\n                            #?@(:cljs [(object? p) (gobj/get p (name nm) dflt)])))\n        (passoc [p nm v] (cond\n                           #?@(:clj [(instance? cljs.tagged_literals.JSValue p) (->JSValue (assoc (.-val p) nm v))])\n                           (map? p) (assoc p nm v)\n                           #?@(:cljs [(object? p) (do (gobj/set p (name nm) v) p)])))\n        (pdissoc [p nm] (cond\n                          #?@(:clj [(instance? cljs.tagged_literals.JSValue p) (->JSValue (dissoc (.-val p) nm))])\n                          (map? p) (dissoc p nm)\n                          #?@(:cljs [(object? p) (do (gobj/remove p (name nm)) p)])))\n        (strip-prefix [s] (str/replace s #\"^[:.#$]*\" \"\"))]\n  (defn fold-in-classes\n    \"Update the :className prop in the given props to include the classes in the :classes entry of props. Works on js objects and CLJ maps as props.\n    If using js props, they must be mutable.\"\n    [props component]\n    (if-let [extra-classes (pget props :classes nil)]\n      (let [old-classes (pget props :className \"\")]\n        (pdissoc\n          (if component\n            (let [clz         (prim/react-type component)\n                  new-classes (combined-classes (clojure.core/map (fn [c]\n                                                                    (let [c (some-> c name)]\n                                                                      (cond\n                                                                        (nil? c) \"\"\n                                                                        (str/starts-with? c \".\") (fulcro-css.css/local-class clz (strip-prefix c))\n                                                                        (str/starts-with? c \"$\") (strip-prefix c)\n                                                                        :else c))) extra-classes) old-classes)]\n              (passoc props :className new-classes))\n            (let [new-classes (combined-classes (clojure.core/map strip-prefix extra-classes) old-classes)]\n              (passoc props :className new-classes)))\n          :classes))\n      props)))\n\n(defn add-kwprops-to-props\n  \"Combine a hiccup-style keyword with props that are either a JS or CLJS map.\"\n  [props kw]\n  (let [{:keys [global-classes classes id] :or {classes []}} (parse kw)\n        classes (vec (concat\n                       (if prim/*parent*\n                         (clojure.core/map #(fulcro-css.css/local-class (prim/react-type prim/*parent*) %) classes)\n                         classes)\n                       global-classes))]\n    (fold-in-classes\n      (if #?(:clj false :cljs (or (nil? props) (object? props)))\n        #?(:clj  props\n           :cljs (let [props            (gobj/clone props)\n                       existing-classes (gobj/get props \"className\")]\n                   (when (seq classes) (gobj/set props \"className\" (combined-classes classes existing-classes)))\n                   (when id (gobj/set props \"id\" id))\n                   props))\n        (let [existing-classes (:className props)]\n          (cond-> (or props {})\n            (seq classes) (assoc :className (combined-classes classes existing-classes))\n            id (assoc :id id))))\n      prim/*parent*)))\n\n\n"]}