shadow$provide.module$node_modules$codemirror$addon$search$searchcursor=function(global,require,module,exports){(function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("module$node_modules$codemirror$lib$codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)})(function(CodeMirror){function ensureFlags(regexp,flags){var current=regexp.flags;for(var target=current=null!=current?current:(regexp.ignoreCase?"i":"")+(regexp.global?"g":
"")+(regexp.multiline?"m":""),i=0;i<flags.length;i++)-1==target.indexOf(flags.charAt(i))&&(target+=flags.charAt(i));return current==target?regexp:new RegExp(regexp.source,target)}function searchRegexpForward(doc,regexp,start){regexp=ensureFlags(regexp,"g");var line=start.line,ch=start.ch;for(start=doc.lastLine();line<=start;line++,ch=0)if(regexp.lastIndex=ch,ch=doc.getLine(line),ch=regexp.exec(ch))return{from:Pos(line,ch.index),to:Pos(line,ch.index+ch[0].length),match:ch}}function searchRegexpForwardMultiline(doc,
regexp,start){if(!/\\s|\\n|\n|\\W|\\D|\[\^/.test(regexp.source))return searchRegexpForward(doc,regexp,start);regexp=ensureFlags(regexp,"gm");for(var string,chunk=1,line=start.line,last=doc.lastLine();line<=last;){for(var i=0;i<chunk&&!(line>last);i++){var curLine=doc.getLine(line++);string=null==string?curLine:string+"\n"+curLine}chunk*=2;regexp.lastIndex=start.ch;if(i=regexp.exec(string))return regexp=string.slice(0,i.index).split("\n"),doc=i[0].split("\n"),start=start.line+regexp.length-1,regexp=
regexp[regexp.length-1].length,{from:Pos(start,regexp),to:Pos(start+doc.length-1,1==doc.length?regexp+doc[0].length:doc[doc.length-1].length),match:i}}}function lastMatchIn(string,regexp){for(var cutOff=0,match;;){regexp.lastIndex=cutOff;cutOff=regexp.exec(string);if(!cutOff)return match;match=cutOff;cutOff=match.index+(match[0].length||1);if(cutOff==string.length)return match}}function searchRegexpBackward(doc,regexp,start){regexp=ensureFlags(regexp,"g");var line=start.line,ch=start.ch;for(start=
doc.firstLine();line>=start;line--,ch=-1){var string=doc.getLine(line);-1<ch&&(string=string.slice(0,ch));if(ch=lastMatchIn(string,regexp))return{from:Pos(line,ch.index),to:Pos(line,ch.index+ch[0].length),match:ch}}}function searchRegexpBackwardMultiline(doc,regexp,start){regexp=ensureFlags(regexp,"gm");for(var string,chunk=1,line=start.line,first=doc.firstLine();line>=first;){for(var i=0;i<chunk;i++){var curLine=doc.getLine(line--);string=null==string?curLine.slice(0,start.ch):curLine+"\n"+string}chunk*=
2;if(i=lastMatchIn(string,regexp))return regexp=string.slice(0,i.index).split("\n"),doc=i[0].split("\n"),line+=regexp.length,regexp=regexp[regexp.length-1].length,{from:Pos(line,regexp),to:Pos(line+doc.length-1,1==doc.length?regexp+doc[0].length:doc[doc.length-1].length),match:i}}}function adjustPos(orig,folded,pos,foldFunc){if(orig.length==folded.length)return pos;var min=0;for(folded=pos+Math.max(0,orig.length-folded.length);;){if(min==folded)return min;var mid=min+folded>>1,len=foldFunc(orig.slice(0,
mid)).length;if(len==pos)return mid;len>pos?folded=mid:min=mid+1}}function searchStringForward(doc,query,start,caseFold){if(!query.length)return null;caseFold=caseFold?doFold:noFold;query=caseFold(query).split(/\r|\n\r?/);var line=start.line;start=start.ch;var last=doc.lastLine()+1-query.length;a:for(;line<=last;line++,start=0){var orig=doc.getLine(line).slice(start),string=caseFold(orig);if(1==query.length){var found=string.indexOf(query[0]);if(-1==found)continue a;adjustPos(orig,string,found,caseFold);
return{from:Pos(line,adjustPos(orig,string,found,caseFold)+start),to:Pos(line,adjustPos(orig,string,found+query[0].length,caseFold)+start)}}found=string.length-query[0].length;if(string.slice(found)!=query[0])continue a;for(var i=1;i<query.length-1;i++)if(caseFold(doc.getLine(line+i))!=query[i])continue a;i=doc.getLine(line+query.length-1);var endString=caseFold(i),lastLine=query[query.length-1];if(endString.slice(0,lastLine.length)!=lastLine)continue a;return{from:Pos(line,adjustPos(orig,string,
found,caseFold)+start),to:Pos(line+query.length-1,adjustPos(i,endString,lastLine.length,caseFold))}}}function searchStringBackward(doc,query,start,caseFold){if(!query.length)return null;caseFold=caseFold?doFold:noFold;query=caseFold(query).split(/\r|\n\r?/);var line=start.line,ch=start.ch,first=doc.firstLine()-1+query.length;a:for(;line>=first;line--,ch=-1){var orig=doc.getLine(line);-1<ch&&(orig=orig.slice(0,ch));ch=caseFold(orig);if(1==query.length){start=ch.lastIndexOf(query[0]);if(-1==start)continue a;
return{from:Pos(line,adjustPos(orig,ch,start,caseFold)),to:Pos(line,adjustPos(orig,ch,start+query[0].length,caseFold))}}var lastLine=query[query.length-1];if(ch.slice(0,lastLine.length)!=lastLine)continue a;var i=1;for(start=line-query.length+1;i<query.length-1;i++)if(caseFold(doc.getLine(start+i))!=query[i])continue a;start=doc.getLine(line+1-query.length);i=caseFold(start);if(i.slice(i.length-query[0].length)!=query[0])continue a;return{from:Pos(line+1-query.length,adjustPos(start,i,start.length-
query[0].length,caseFold)),to:Pos(line,adjustPos(orig,ch,lastLine.length,caseFold))}}}function SearchCursor(doc,query,pos$jscomp$0,options){this.atOccurrence=!1;this.doc=doc;pos$jscomp$0=pos$jscomp$0?doc.clipPos(pos$jscomp$0):Pos(0,0);this.pos={from:pos$jscomp$0,to:pos$jscomp$0};if("object"==typeof options)var caseFold=options.caseFold;else caseFold=options,options=null;"string"==typeof query?(null==caseFold&&(caseFold=!1),this.matches=function(reverse,pos){return(reverse?searchStringBackward:searchStringForward)(doc,
query,pos,caseFold)}):(query=ensureFlags(query,"gm"),this.matches=options&&!1===options.multiline?function(reverse,pos){return(reverse?searchRegexpBackward:searchRegexpForward)(doc,query,pos)}:function(reverse,pos){return(reverse?searchRegexpBackwardMultiline:searchRegexpForwardMultiline)(doc,query,pos)})}var Pos=CodeMirror.Pos;if(String.prototype.normalize){var doFold=function(str){return str.normalize("NFD").toLowerCase()};var noFold=function(str){return str.normalize("NFD")}}else doFold=function(str){return str.toLowerCase()},
noFold=function(str){return str};SearchCursor.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(reverse){for(var result=this.matches(reverse,this.doc.clipPos(reverse?this.pos.from:this.pos.to));result&&0==CodeMirror.cmpPos(result.from,result.to);)reverse?result.from.ch?result.from=Pos(result.from.line,result.from.ch-1):result=result.from.line==this.doc.firstLine()?null:this.matches(reverse,this.doc.clipPos(Pos(result.from.line-1))):result.to.ch<
this.doc.getLine(result.to.line).length?result.to=Pos(result.to.line,result.to.ch+1):result=result.to.line==this.doc.lastLine()?null:this.matches(reverse,Pos(result.to.line+1,0));if(result)return this.pos=result,this.atOccurrence=!0,this.pos.match||!0;reverse=Pos(reverse?this.doc.firstLine():this.doc.lastLine()+1,0);this.pos={from:reverse,to:reverse};return this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(newText,
origin){this.atOccurrence&&(newText=CodeMirror.splitLines(newText),this.doc.replaceRange(newText,this.pos.from,this.pos.to,origin),this.pos.to=Pos(this.pos.from.line+newText.length-1,newText[newText.length-1].length+(1==newText.length?this.pos.from.ch:0)))}};CodeMirror.defineExtension("getSearchCursor",function(query,pos,caseFold){return new SearchCursor(this.doc,query,pos,caseFold)});CodeMirror.defineDocExtension("getSearchCursor",function(query,pos,caseFold){return new SearchCursor(this,query,pos,
caseFold)});CodeMirror.defineExtension("selectMatches",function(query,caseFold){var ranges=[];for(query=this.getSearchCursor(query,this.getCursor("from"),caseFold);query.findNext()&&!(0<CodeMirror.cmpPos(query.to(),this.getCursor("to")));)ranges.push({anchor:query.from(),head:query.to()});ranges.length&&this.setSelections(ranges,0)})})}
//# sourceMappingURL=module$node_modules$codemirror$addon$search$searchcursor.js.map
