{"version":3,"sources":["com/wsscode/pathom/viz/trace.cljs"],"mappings":"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","names":["com.wsscode.pathom.viz.trace/render-trace","this","map__56738","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","trace-data","on-show-details","fulcro.client.primitives/props","container","goog.object/get","svg","goog.object/set","G__56741","G__56742","G__56743","G__56744","G__56745","js/module$com$wsscode$pathom$viz$d3_trace.renderPathomTrace","cljs.core/clj->js","com.wsscode.pathom.viz.helpers/stringify-keyword-values","or__4131__auto__","cljs.core/identity","com.wsscode.pathom.viz.trace/recompute-trace-size","G__56747","js/module$com$wsscode$pathom$viz$d3_trace.updateTraceSize","G__56748","G__56749","G__56750","G__56751","G__56753","G__56754","G__56755","js/com","js/com.wsscode","js/com.wsscode.pathom","js/com.wsscode.pathom.viz","js/com.wsscode.pathom.viz.trace","js/com.wsscode.pathom.viz.trace.D3Trace","this__44526__auto__","js/React.Component","G__56762","G__56763","js/React.Component.prototype","G__56764","fulcro.client.primitives/default-component-prototype","goog.object/extend","fulcro.client.primitives/-register-component!","x56765","this__43444__auto__","*reconciler*-orig-val__56766","fulcro.client.primitives/*reconciler*","*depth*-orig-val__56767","fulcro.client.primitives/*depth*","*shared*-orig-val__56768","fulcro.client.primitives/*shared*","*instrument*-orig-val__56769","fulcro.client.primitives/*instrument*","*parent*-orig-val__56770","fulcro.client.primitives/*parent*","*reconciler*-temp-val__56771","fulcro.client.primitives/get-reconciler","*depth*-temp-val__56772","fulcro.client.primitives/depth","*shared*-temp-val__56773","fulcro.client.primitives.shared.cljs$core$IFn$_invoke$arity$1","*instrument*-temp-val__56774","fulcro.client.primitives/instrument","*parent*-temp-val__56775","prev-props__43421__auto__","prev-state__43422__auto__","snapshot__43423__auto__","this__43420__auto__","snapshot56759","ident__43424__auto__","fulcro.client.primitives/ident","next-ident__43425__auto__","cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2","idxr__43426__auto__","cljs.core.get_in.cljs$core$IFn$_invoke$arity$2","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2","indexes__43427__auto__","cljs.core.update_in.cljs$core$IFn$_invoke$arity$4","cljs.core/disj","cljs.core.fnil.cljs$core$IFn$_invoke$arity$2","cljs.core/conj","this__43428__auto__","reconciler__43429__auto__","lifecycle__43430__auto__","indexer__43431__auto__","fulcro.client.impl.protocols/index-component!","G__56794","G__56795","x56800","_","x56805","this__44529__auto__","writer__44530__auto__","opt__44531__auto__","cljs.core/-write","com.wsscode.pathom.viz.trace/D3Trace","G__56796","G__56797","js/module$com$wsscode$pathom$viz$detect_element_size.addResizeListener","prev-props","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","error","info","fulcro.client.primitives.set_state_BANG_.cljs$core$IFn$_invoke$arity$2","p1__56756#","fulcro.client.localized_dom.div.cljs$core$IFn$_invoke$arity$variadic","fulcro.client.primitives.get_state.cljs$core$IFn$_invoke$arity$2","p1__56757#","fulcro.client.localized_dom.svg.cljs$core$IFn$_invoke$arity$variadic","com.wsscode.pathom.viz.trace/d3-trace","fulcro.client.primitives.factory.cljs$core$IFn$_invoke$arity$1"],"sourcesContent":["(ns com.wsscode.pathom.viz.trace\n  (:require [\"./d3-trace\" :refer [renderPathomTrace updateTraceSize]]\n            [\"./detect-element-size\" :refer [addResizeListener]]\n            [clojure.walk :as walk]\n            [com.wsscode.pathom.viz.helpers :as h]\n            [fulcro.client.localized-dom :as dom]\n            [fulcro.client.mutations :as fm]\n            [fulcro.client.primitives :as fp]\n            [goog.object :as gobj]))\n\n(defn render-trace [this]\n  (let [{::keys [trace-data on-show-details]} (-> this fp/props)\n        container (gobj/get this \"svgContainer\")\n        svg (gobj/get this \"svg\")]\n    (gobj/set svg \"innerHTML\" \"\")\n    (gobj/set this \"renderedData\"\n      (renderPathomTrace svg\n        (clj->js {:svgWidth    (gobj/get container \"clientWidth\")\n                  :svgHeight   (gobj/get container \"clientHeight\")\n                  :data        (h/stringify-keyword-values trace-data)\n                  :showDetails (or on-show-details identity)})))))\n\n(defn recompute-trace-size [this]\n  (let [container (gobj/get this \"svgContainer\")]\n    (updateTraceSize\n      (doto (gobj/get this \"renderedData\")\n        (gobj/set \"svgWidth\" (gobj/get container \"clientWidth\"))\n        (gobj/set \"svgHeight\" (gobj/get container \"clientHeight\"))))))\n\n(fp/defsc D3Trace [this _]\n  {:css\n   [[:.container {:flex      1\n                  :max-width \"100%\"}]\n\n    [:$pathom-attribute\n     {:fill    \"#d4d4d4\"\n      :opacity \"0.5\"}\n\n     [:&:hover\n      {:fill \"#94a0ad\"}]]\n\n    [:$pathom-attribute-bounds\n     {:fill             \"none\"\n      :opacity          \"0.5\"\n      :stroke           \"#000\"\n      :stroke-dasharray \"5 1\"\n      :visibility       \"hidden\"}]\n\n    [:$pathom-detail-marker\n     {:fill    \"#a4e3bf\"\n      :opacity \"0.9\"}\n     [:&:hover\n      {:opacity \"1\"}]]\n\n    [:$pathom-event-waiting-resolver\n     {:fill \"#de5615\"}]\n\n    [:$pathom-event-skip-wait-key\n     {:fill \"#de5615\"}]\n\n    [:$pathom-event-external-wait-key\n     {:fill \"#de5615\"}]\n\n    [:$pathom-event-call-resolver\n     {:fill \"#af9df4\"}]\n\n    [:$pathom-event-call-resolver-batch\n     {:fill \"rgba(42, 0, 208, 0.5)\"}]\n\n    [:$pathom-event-schedule-resolver\n     {:fill \"#efaf42\"}]\n\n    [:$pathom-event-error\n     {:fill \"#bb0808\"}]\n\n    [:$pathom-label-text\n     {:font-family    \"sans-serif\"\n      :fill           \"#222\"\n      :font-size      \"11px\"\n      :pointer-events \"none\"}]\n\n    [:$pathom-vruler\n     {:stroke       \"#2b98f0\"\n      :stroke-width \"2px\"\n      :visibility   \"hidden\"}]\n\n    [:$pathom-axis\n     [:line\n      {:stroke \"#e5e5e5\"}]]\n\n    [:$pathom-tooltip\n     {:position       \"fixed\"\n      :pointer-events \"none\"\n      :font-size      \"12px\"\n      :font-family    \"sans-serif\"\n      :background     \"#fff\"\n      :padding        \"1px 6px\"\n      :word-break     \"break-all\"\n      :box-shadow     \"#00000069 0px 1px 3px 0px\"\n      :white-space    \"nowrap\"\n      :top            \"-1000px\"\n      :left           \"-1000px\"\n      :z-index        \"10\"}]\n\n    [:$pathom-details-count\n     {:background    \"#8bdc47\"\n      :border-radius \"7px\"\n      :padding       \"1px 5px\"\n      :font-size     \"10px\"\n      :font-family   \"sans-serif\"}]\n\n    [:$pathom-children-count\n     {:background    \"#d2a753\"\n      :border-radius \"7px\"\n      :padding       \"1px 5px\"\n      :font-size     \"10px\"\n      :font-family   \"sans-serif\"}]\n\n    [:$pathom-attribute-toggle-children\n     {:cursor      \"default\"\n      :fill        \"#757575\"\n      :font-size   \"16px\"\n      :font-family \"monospace\"\n      :font-weight \"bold\"\n      :text-anchor \"middle\"\n      :transform   \"translate(-8px, 13px)\"}]]\n\n   :componentDidMount\n   (fn []\n     (render-trace this)\n     (addResizeListener (gobj/get this \"svgContainer\") #(recompute-trace-size this)))\n\n   :componentDidUpdate\n   (fn [prev-props _]\n     (if (= (-> prev-props ::trace-data)\n            (-> this fp/props ::trace-data))\n       (recompute-trace-size this)\n       (render-trace this)))\n\n   :componentDidCatch\n   (fn [error info]\n     (fp/set-state! this {::error-catch? true}))}\n\n  (dom/div :.container {:ref #(gobj/set this \"svgContainer\" %)}\n    (if (fp/get-state this ::error-catch?)\n      (dom/div \"Error rendering trace, check console for details\")\n      (dom/svg {:ref #(gobj/set this \"svg\" %)}))))\n\n(def d3-trace (fp/factory D3Trace))\n"]}