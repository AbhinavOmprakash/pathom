{
"version":3,
"file":"module$com$wsscode$pathom$viz$d3_attribute_graph.js",
"lineCount":192,
"mappings":"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",
"sources":["com/wsscode/pathom/viz/d3-attribute-graph.js"],
"sourcesContent":["import * as d3 from \"/node_modules/d3/dist/d3.node.js\";\n\nconst DEFAULTS = {\n  showDetails: function () {}\n}\n\nfunction init(element, settings) {\n  const svg = d3.select(element)\n\n  return Object.assign({}, DEFAULTS, settings, {svg, element})\n}\n\nexport function render(element, data) {\n  const settings = init(element, data)\n  const {svg, svgWidth, svgHeight, showDetails, onClickEdge} = settings\n  const colorScale = d3.scaleOrdinal(d3.schemeCategory10)\n\n  svg\n    .attr('width', svgWidth)\n    .attr('height', svgHeight)\n\n  const {nodes, links} = settings.data\n\n  const container = svg.append(\"g\")\n\n  const zoom = d3.zoom().on(\"zoom\",\n    function () {\n      container.attr(\"transform\", d3.event.transform)\n    }\n  )\n\n  svg.call(zoom);\n\n  // build the arrows.\n  svg.append(\"svg:defs\").selectAll(\"marker\")\n    .data([\"arrow-provides\", \"arrow-reaches\"])\n    .join(\"svg:marker\")\n    .attr(\"id\", d => d)\n    .attr(\"viewBox\", \"0 -5 10 10\")\n    .attr(\"refX\", 15)\n    .attr(\"refY\", 0)\n    .attr(\"markerWidth\", 6)\n    .attr(\"markerHeight\", 6)\n    .attr(\"markerUnits\", 'userSpaceOnUse')\n    .attr(\"orient\", \"auto\")\n    .attr('class', d => 'pathom-viz-index-explorer-' + d)\n    .append(\"svg:path\")\n    .attr(\"d\", \"M0,-5L10,0L0,5\");\n\n  const simulation = d3.forceSimulation(nodes)\n    .force(\"link\", d3.forceLink(links).id(d => d.attribute).distance(90).strength(0.1))\n    .force(\"charge\", d3.forceManyBody().strength(-60))\n    .force('collision', d3.forceCollide().radius(d => d.radius * 1.6))\n    .force(\"center\", d3.forceCenter(svgWidth / 2, svgHeight / 2))\n\n  settings.simulation = simulation\n\n  const linksIndex = {};\n\n  const highlightEdge = function (resolvers) {\n    if (linksIndex[resolvers]) {\n      linksIndex[resolvers].forEach(line => {\n        line.classed(\"pathom-viz-index-explorer-attr-link-focus-highlight\", true)\n      });\n\n      label.html(resolvers)\n    }\n  }\n\n  const unhighlightEdge = function (resolvers) {\n    if (linksIndex[resolvers]) {\n      linksIndex[resolvers].forEach(line => {\n        line.classed(\"pathom-viz-index-explorer-attr-link-focus-highlight\", false)\n      });\n\n      label.html('')\n    }\n  }\n\n  settings.highlightEdge = highlightEdge\n  settings.unhighlightEdge = unhighlightEdge\n\n  const link = container.append(\"g\")\n    .selectAll(\"line\")\n    .data(links)\n    .join(\"svg:path\")\n    .attr('class', 'pathom-viz-index-explorer-attr-link')\n    .attr(\"marker-end\", \"url(#arrow-provides)\")\n    .classed('pathom-viz-index-explorer-attr-link-deep', d => d.deep)\n    .each(function (d) {\n      d.ownerLine = d3.select(this)\n      const lines = linksIndex[d.resolvers] || [];\n      lines.push(d.ownerLine);\n      linksIndex[d.resolvers] = lines;\n    })\n    .on('click', function({resolvers}) {\n      onClickEdge({resolvers});\n    })\n    .on('mouseenter', function(d) {\n      highlightEdge(d.resolvers)\n    })\n    .on('mouseleave', function(d) {\n      unhighlightEdge(d.resolvers)\n    });\n\n  const drag = simulation => {\n    function dragstarted(d) {\n      if (!d3.event.active) simulation.alphaTarget(0.3).restart();\n      d.fx = d.x;\n      d.fy = d.y;\n    }\n\n    function dragged(d) {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    }\n\n    function dragended(d) {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    }\n\n    return d3.drag()\n      .on(\"start\", dragstarted)\n      .on(\"drag\", dragged)\n      .on(\"end\", dragended);\n  }\n\n  let label\n\n  const highlight = function (d) {\n    d.nodeElement.classed('pathom-viz-index-explorer-attr-node-highlight', true)\n\n    d.lineTargets.forEach(line => {\n      line.ownerLine.classed(\"pathom-viz-index-explorer-attr-link-target-highlight\", true)\n    })\n\n    d.lineSources.forEach(line => {\n      line.ownerLine.classed(\"pathom-viz-index-explorer-attr-link-source-highlight\", true)\n    })\n\n    return label.html(d.attribute)\n  }\n\n  const unhighlight = function (d) {\n    d.nodeElement.classed('pathom-viz-index-explorer-attr-node-highlight', false)\n\n    d.lineTargets.forEach(line => {\n      line.ownerLine.classed(\"pathom-viz-index-explorer-attr-link-target-highlight\", false)\n    })\n\n    d.lineSources.forEach(line => {\n      line.ownerLine.classed(\"pathom-viz-index-explorer-attr-link-source-highlight\", false)\n    })\n\n    return label.html('')\n  }\n\n  settings.highlightNode = function (id) {\n    const d = nodes.find(x => x.attribute === id)\n\n    if (d) highlight(d)\n  }\n\n  settings.unhighlightNode = function (id) {\n    const d = nodes.find(x => x.attribute === id)\n\n    if (d) unhighlight(d)\n  }\n\n  const extractNs = function(str) {\n    if (str.startsWith(\"#\")) return null;\n\n    const parts = str.split(\"/\");\n\n    if (parts.length > 1) {\n      return parts[0].substr(1);\n    }\n\n    return null;\n  }\n\n  const node = container.append(\"g\")\n    .selectAll(\"circle\")\n    .data(nodes)\n    .join(\"circle\")\n    .attr('class', 'pathom-viz-index-explorer-attr-node')\n    .classed('pathom-viz-index-explorer-attr-node-multi', d => d.multiNode)\n    .classed('pathom-viz-index-explorer-attr-node-main', d => d.mainNode)\n    .attr(\"stroke-width\", d => Math.sqrt(d.reach || 1) + 1)\n    .attr(\"r\", d => Math.sqrt(d.weight || 1) + 2)\n    .attr(\"stroke\", d => d.multiNode ? null : colorScale(extractNs(d.attribute)))\n    .each(function(d) {\n      d.nodeElement = d3.select(this)\n\n      d.lineTargets = links.filter(l => {\n        return l.source.attribute === d.attribute;\n      });\n      d.lineSources = links.filter(l => {\n        return l.target.attribute === d.attribute;\n      });\n    })\n    .on('click', function(d) {\n      showDetails(d.attribute, d, this)\n    })\n    .on('mouseenter', function(d) {\n      return highlight(d)\n    })\n    .on('mouseleave', function(d) {\n      return unhighlight(d)\n    })\n    .call(drag(simulation))\n\n  label = svg.append('text')\n    .attr('x', 10)\n    .attr('y', 30)\n    .html('')\n\n  simulation.on(\"tick\", () => {\n    link\n      .attr(\"d\", function (d) {\n        const dx = d.target.x - d.source.x,\n          dy = d.target.y - d.source.y,\n          // dr = Math.sqrt(dx * dx + dy * dy),\n          gamma = Math.atan2(dy,dx),\n          tx = d.target.x - (Math.cos(gamma) * d.target.radius),\n          ty = d.target.y - (Math.sin(gamma) * d.target.radius),\n\n          sdx = d.source.x - d.target.x,\n          sdy = d.source.y - d.target.y,\n          sgamma = Math.atan2(sdy,sdx),\n          sx = d.source.x - (Math.cos(sgamma) * d.source.radius),\n          sy = d.source.y - (Math.sin(sgamma) * d.source.radius);\n        return \"M\" +\n          sx + \",\" +\n          sy + \"L\" +\n          tx + \",\" +\n          ty;\n      });\n\n    node\n      .attr(\"cx\", d => d.x)\n      .attr(\"cy\", d => d.y);\n  });\n\n  settings.dispose = function () {\n    simulation.stop()\n  }\n\n  return settings\n}\n"],
"names":["DEFAULTS","showDetails","init","element","settings","svg","d3","select","Object","assign","render","data","svgWidth","svgHeight","onClickEdge","colorScale","scaleOrdinal","schemeCategory10","attr","nodes","links","container","append","zoom","on","event","transform","call","selectAll","join","d","simulation","forceSimulation","force","forceLink","id","attribute","distance","strength","forceManyBody","forceCollide","radius","forceCenter","linksIndex","highlightEdge","resolvers","forEach","line","classed","label","html","unhighlightEdge","link","deep","each","ownerLine","lines","push","drag","dragstarted","active","alphaTarget","restart","fx","x","fy","y","dragged","dragended","highlight","nodeElement","lineTargets","lineSources","unhighlight","highlightNode","settings.highlightNode","find","unhighlightNode","settings.unhighlightNode","extractNs","str","startsWith","parts","split","length","substr","node","multiNode","mainNode","Math","sqrt","reach","weight","filter","l","source","target","dx","dy","gamma","atan2","tx","cos","ty","sin","sdx","sdy","sgamma","sx","sy","dispose","settings.dispose","stop","exports"]
}
