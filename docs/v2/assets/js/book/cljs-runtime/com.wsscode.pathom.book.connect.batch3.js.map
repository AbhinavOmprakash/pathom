{"version":3,"sources":["com/wsscode/pathom/book/connect/batch3.cljs"],"mappings":";;;;;AAKA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAgBC,AAAaC,AAAEA;AAA/B,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA;;AAMA,AAAA,AAAAF,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAgBG,AAAeD,AAAEE,AAKfC;AALlB,AAME,AAAAC,AAAA,AAAAC,AAAA;AAAA,AAAA,AAAAC,AAAA;;AAAA,AAAA,AAAAC,AAAA,AAAAC,AAAA;AAAAC;AAAA,AAAA,AAAAC,AAAA,AAAAD,AAAA;AAAA,AAAA,AAAA,AAAAC,AAAA;AAAA,AAAAC,AAAA,AAAA,AACaqB;AADbvB,AAAAA;AAAA,AAAA,AAAAG,AAAAH,AAAA,AAAAE;;AAAA,AAAA,AAAAD,AAAA;AAAA,AAAAG,AAAA,AAAAJ,AAAA;AAAAK,AAAA,AAAA,AAGQ;AAAKoB;AAAL,AAAA,AAAA,AAAuB,AAAA,AAAK,AAAA,AAASA;;;;AAH7CnB,AAAA,AAAAD,AAGGmB,AAAgD/B;AAHnDO,AAAA,AAAAO,AAAAP;AAAA,AAAA,AAAAO,AAAA,AAAAH;;AAAAG;;AAAA,AAAA,AAAAC,AAAAR,AAAAM;;AAAA;;;;;AAAA,AAAA;;;;AAAA,AAAA,AAAAG,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAA,AAAAC;;AAAA,AAAAD,AAAA,AAAA;;AAAAA;;AAAAT;;AAAA,AAAA,AAAAW,AAAA,AAAA,AAAA;AAAA,AAAA,AAAAC,AAAA,AAAAb,AAAAC;AAAA,AAAA,AAAA,AAAAa,AAAAD,AAAA;AAAA;;AAAAA;;;;AAAA,AAAA,AAAAE,AAAAC;AAAA,AAAAC,AAAAF;AAAA,AAAA,AAAAG,AAAAjB;AAAA,AAAA,AAAAiB,AAAA,AAAAD;;AAAAC;AAAA,AAAAC,AAAAlB;;AAAA;;AAAA,AAAA,AAAAc;;;;AAAA,AAAA,AAAA,AAAAD,AAAAF,AAAA;AAAA,AAAAX;;;;AAAAW;;;;;AAAAX;;;;;AAAAA;;;;;;;;;;AAAAmB,AAAA,AAAAC,AAAA,AAAAtB,AAAAA,AAAAA;AAAA,AAAA,AAAAsB,AAAAC,AAAA,AAAA1B;;AAAAyB;;AAAA,AAAA,AAAAE,AAAAH;;;;AAAAxB;;AAKF,AAAA,AAAK+B,AAAcpC,AAAYE;AAE/B,AAAKmC,AACH,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAACC,AACkCC,AACAC,AACAC,AACD,AAAKC,AAAIC;AAAT,AACE,AAAA,AAACC,AAAyBD;;AAC1B,AAACE,AAAYF;AANjD,AAAA,AAAA,AAOeG,AACC,AAAA,AAAA,AAACC,AAAiCX,AAClCY,AACAC","names":["com.wsscode.pathom.connect/resolver","com.wsscode.pathom.book.connect.batch3/list-things","_","com.wsscode.pathom.book.connect.batch3/slow-resolver","input","com.wsscode.pathom.connect/transform-batch-resolver","c__38971__auto__","cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1","cljs.core.async.impl.dispatch/run","f__38972__auto__","switch__38924__auto__","state_52915","state_val_52916","inst_52902","cljs.core.async.impl.ioc-helpers/take!","inst_52904","inst_52908","inst_52909","statearr-52949","cljs.core.async.impl.ioc-helpers/return-chan","statearr-52955","state-machine__38925__auto__","ret-value__38926__auto__","result__38927__auto__","cljs.core/keyword-identical?","e52967","js/Object","ex__38928__auto__","statearr-52968","cljs.core.async.impl.ioc-helpers/process-exception","state__38973__auto__","statearr-53023","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","cljs.core.async/timeout","cljs.core.mapv.cljs$core$IFn$_invoke$arity$2","v","com.wsscode.pathom.book.connect.batch3/app-registry","com.wsscode.pathom.book.connect.batch3/parser","com.wsscode.pathom.core/async-parser","com.wsscode.pathom.core/map-reader","com.wsscode.pathom.connect/async-reader2","com.wsscode.pathom.connect/open-ident-reader","env","error","js/console.error","com.wsscode.pathom.core/error-str","com.wsscode.pathom.connect/mutate-async","com.wsscode.pathom.connect.connect_plugin.cljs$core$IFn$_invoke$arity$1","com.wsscode.pathom.core/error-handler-plugin","com.wsscode.pathom.core/trace-plugin"],"sourcesContent":["(ns com.wsscode.pathom.book.connect.batch3\n  (:require [com.wsscode.pathom.core :as p]\n            [com.wsscode.pathom.connect :as pc]\n            [cljs.core.async :as async :refer [go]]))\n\n(pc/defresolver list-things [_ _]\n  {::pc/output [{:items [:number]}]}\n  {:items [{:number 3}\n           {:number 10}\n           {:number 18}]})\n\n(pc/defresolver slow-resolver [_ input]\n  {::pc/input     #{:number}\n   ::pc/output    [:number-added]\n   ; use the transform, note we removed ::pc/batch? true, that's because the transform\n   ; will add this for us\n   ::pc/transform pc/transform-batch-resolver}\n  (go\n    (async/<! (async/timeout 1000))\n    ; no need to detect sequence, it is always a sequence now\n    (mapv (fn [v] {:number-added (inc (:number v))}) input)))\n\n(def app-registry [list-things slow-resolver])\n\n(def parser\n  (p/async-parser\n    {::p/env     {::p/reader        [p/map-reader\n                                     pc/async-reader2\n                                     pc/open-ident-reader]\n                  ::p/process-error (fn [env error]\n                                      (js/console.error \"ERROR\" error)\n                                      (p/error-str error))}\n     ::p/mutate  pc/mutate-async\n     ::p/plugins [(pc/connect-plugin {::pc/register app-registry})\n                  p/error-handler-plugin\n                  p/trace-plugin]}))\n"]}