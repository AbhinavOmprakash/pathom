{"version":3,"sources":["com/wsscode/pathom/book/app_types.cljs"],"mappings":";;;;;;;;AAQA,AAAA,AAAMA,AAAWC,AAAKC;AAAtB,AACE,AAAA,AAAA,AAAA;;;;AAAAC,AAAA;AAAA,AAAA,AAAAC,AAAA;AAAA,AAAA,AAAAC,AAAAD,AAAA;;AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA;AAAA,AAAA,AAAAA,AAAA,AAAAA;;AAAA,AAAA,AAAAA,AAAA;;;AAAAA;;;AAAA,AAAAE,AAAA,AAAAH;AAAAI,AAAAC;AAAAC,AAAAC;AAAA,AAAA,AAAAC,AAAAL,AAAAC,AAAAE;;AAAA,AAAAG,AAAA,AAAAT;;AAAA,AAAAU,AAAA,AAAAV;AAAA,AAAA,AAAA,AAAA,AAAAU,AAAA;;AAAA,AAAA,AAAAC,AAAA;AAAA,AAAA,AAAAA,AAaW+B;AAbX,AAAA,AAAA9B,AAAAC;AAAAC,AAAAC;AAAAC,AAAAC;AAAAC,AAAAC;AAAAC,AAAAC;AAAAC,AAAA,AAAAC,AAAAZ;AAAAa,AAAA,AAAA,AAAAC,AAAAd,AAAA;AAAAe,AAAA,AAAAC,AAAAhB;AAAAiB,AAAA,AAAAC,AAAAlB;AAAAmB,AAAAnB;AAAA,AAAA,AAAAE,AAAAS;;AAAA,AAAAP,AAAAS;;AAAA,AAAAP,AAAAS;;AAAA,AAAAP,AAAAS;;AAAA,AAAAP,AAAAS;;AAAA,AAAA,AAcI,AAAAa,AAAwB,AAACK,AAASN;AAAlCC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAX,AAAA,AAAAW,AAAA,AAAA,AAAA,AAAA,AAAAC,AAAAC,AAAAF,AAAAA;AAAA,AAAAG,AAAAH,AAAA,AAAiBI;AACXE,AAAQ,AAACC,AAAWpD;AAD1B,AAEE,AAACmD,AAAAA,AAAAA,AAAQF,AAAAA;AAhBf,AAAA,AAAA1B,AAAAD;;AAAA,AAAAD,AAAAD;;AAAA,AAAAD,AAAAD;;AAAA,AAAAD,AAAAD;;AAAA,AAAAD,AAAAD;;;;AAAAF;AAAA,AAAA,AAAA,AAAAV,AAAAA;;AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA;;AAAA,AAAA,AAAA,AAu/GuC,AAAAA;;AAv/GvC,AAAA+B,AAAA/B;AAAA,AAAA,AAAA,AAAA,AAAA+B,AAAAC;;AAAA,AAAA,AAAAD,AAEE;AAAgBO,AAAEC;AAAlB,AAAA,AAAA,AAAgBD;AAAhB,AAAA,AAAA,AAAA,AAAuDvC,AACnB,AAACyC,AAAqB1C,AAAKyC;;;;AAHjE,AAAA,AAAAR,AAAAC;;AAAA,AAAA,AAAAD,AAME;AAAQO;AAAR,AAAA,AAAA,AAAQA;AAAR,AAAA,AAAA,AAAA,AAAsB,AAACG,AAAa3C;;;;AANtC,AAAA,AAAAiC,AAAAC;;AAAA,AAAA,AAAAD,AASE;AAAcO;AAAd,AAAA,AAAA,AAAcA;AAAd,AAAA;;;;AATF,AAAA,AAAAP,AAUE;AAAmBO;AAAnB,AAAA,AAAA,AAAmBA;AAAnB,AAAA,AAAuBxC;;;;AAVzBiC;AAAA,AAAAE,AAAA,AAAAjC;AAAA,AAAA,AAAA,AAAA,AAAAiC,AAAAD;;AAAA,AAAA,AAAAC,AAEE;AAAgBK,AAAEC;AAAlB,AAAA,AAAA,AAAgBD;AAAhB,AAAA,AAAA,AAAA,AAAuDvC,AACnB,AAACyC,AAAqB1C,AAAKyC;;;;AAHjE,AAAA,AAAAN,AAAAD;;AAAA,AAAA,AAAAC,AAME;AAAQK;AAAR,AAAA,AAAA,AAAQA;AAAR,AAAA,AAAA,AAAA,AAAsB,AAACG,AAAa3C;;;;AANtC,AAAA,AAAAmC,AAAAD;;AAAA,AAAA,AAAAC,AASE;AAAcK;AAAd,AAAA,AAAA,AAAcA;AAAd,AAAA;;;;AATF,AAAA,AAAAL,AAUE;AAAmBK;AAAnB,AAAA,AAAA,AAAmBA;AAAnB,AAAA,AAAuBxC;;;;AAVzBmC;AAAA,AAAA,AAAAjC,AAAA;;AAAA,AAAA,AAAAA,AAAA;;AAAA,AAAA,AAAAA,AAAA,AAAAkC,AAAAC,AAAAC;AAAA,AAAA,AAAAC,AAAAF,AAAA;;;AAAAnC;;AAkBF,AAAA,AAAAmD,AAAAC,AAAAC,AAAAC,AAAAC,AAAAC;AAAA;AAAA,AAAA,AAASC,AAAK,AAAA,AAACC;;AACf,AAAA,AAAAP,AAAAC,AAAAC,AAAAC,AAAAC,AAAAI;AAAA;AAAA,AAAA,AAASC,AAAU,AAAA,AAACF;;AAEpB,AAAA,AAAMG,AAAcC,AAAKC;AAAzB,AACE,AAACC,AAAMJ,AAAUK,AAAMH,AAAKC;;AAE9B,AAAA,AAAMG;AAAN,AACE,AAAAC,AAAA,AAAAC,AAAA,AAAAC,AAAmCZ;AAAnCa,AAAA;AAAAC,AAAA;AAAAC,AAAA;;AAAA,AAAA,AAAA,AAAA,AAAAA,AAAAD;AAAA,AAAAE,AAAA,AAAAH,AAAAE;AAAA,AAAAE,AAAAD,AAAA,AAAA,AAASa;AAATX,AAAA,AAAAD,AAAAD,AAAA,AAAA;AAAAE,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA3C,AAAA,AAAA2C,AAAA,AAAA,AAAA,AAAA,AAAA/B,AAAAC,AAAA8B,AAAAA;AAAA,AAAA7B,AAAA6B,AAAA,AAAqB5B;AAArB,AAAAD,AAAA6B,AAAA,AAA0BY;AAA1B,AAAA,AACE,AAAA,AAAA,AAACC,AAAM/B,AAAKgC,AAAWH,AAAUI,AAAa3C,AAAKwC;;AACnD,AAAA,AAAA,AAAIA;;AAFN;AAAA,AAAApB;AAAAG;AAAAC;AAAA,AAAAC,AAAA;;;;;;;AAAA,AAAAI,AAAA,AAAAR,AAAAD;AAAA,AAAA,AAAAS;AAAA,AAAA,AAAAT,AAAAS;AAAA,AAAA,AAAA,AAAAC,AAAAV;AAAA,AAAAW,AAAA,AAAAC,AAAAZ;AAAA,AAAA,AAAA,AAAAa,AAAAb;AAAAW;AAAA,AAAAG,AAAAH;AAAA;;;;;;;AAAA,AAAAI,AAAA,AAAAC,AAAAhB;AAAA,AAAAO,AAAAQ,AAAA,AAAA,AAASI;AAATF,AAAA,AAAAV,AAAAQ,AAAA,AAAA;AAAAE,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAApD,AAAA,AAAAoD,AAAA,AAAA,AAAA,AAAA,AAAAxC,AAAAC,AAAAuC,AAAAA;AAAA,AAAAtC,AAAAsC,AAAA,AAAqBrC;AAArB,AAAAD,AAAAsC,AAAA,AAA0BG;AAA1B,AAAA,AACE,AAAA,AAAA,AAACC,AAAM/B,AAAKgC,AAAWH,AAAUI,AAAa3C,AAAKwC;;AACnD,AAAA,AAAA,AAAIA;;AAFN;AAAA,AAAA,AAAAF,AAAAlB;AAAA;AAAA;AAAA;;;;;;;;AAAA;;;;;;AAIF,AAAA,AAAMwB,AAAW7B,AAAKyB;AAAtB,AACE,AAAAK,AAAqB,AAAA,AAAAvB,AAACvB,AAAKc,AAAUE;AAArC,AAAA,AAAA8B;AAAA,AAAAA,AAASC;AAAT,AACE,AAAMP,AAAI,AAACS;AAAXD,AAC0B,AAAAG,AAAA,AAAA,AAAqBV;AAArB,AAAA,AAAAU,AAAAA,AAACJ,AAAAA,AAAAA;;AAD3BC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA9D,AAAA,AAAA8D,AAAA,AAAA,AAAA,AAAA,AAAAlD,AAAAC,AAAAiD,AAAAA;AAAA,AAAAhD,AAAAgD,AAAA,AACe/C;AADf,AAAAD,AAAAgD,AAAA,AACoBE;AACdA,AAAI,AAAAE,AAAIF;AAAJ,AAAA,AAAAE;AAAAA;;AAAQ,AAAA,AAACC,AAEC,AAACC,AAAaC,AACA,AAAA,AAACC,AAAcC;;;AALjD,AAME,AAAA,AAAA,AAACC,AAAyBlB,AAAevC;;AACzC,AAAA,AAAA,AAAA,AAAA,AAACiB,AAAMP,AAAKQ,AAAMqB,AAAUU,AAAWjD,AAAYwC;;AACrD,AAAA,AAAA,AAACkB,AAA2B3C","names":["com.wsscode.pathom.book.app-types/make-root","Root","app-id","com.wsscode.pathom.book.app-types/ui_49398","this__43233__auto__","js/React.Component","G__49474","G__49475","js/React.Component.prototype","G__49476","fulcro.client.primitives/default-component-prototype","goog.object/extend","fulcro.client.primitives/-register-component!","x49477","this__42151__auto__","*reconciler*-orig-val__49486","fulcro.client.primitives/*reconciler*","*depth*-orig-val__49487","fulcro.client.primitives/*depth*","*shared*-orig-val__49488","fulcro.client.primitives/*shared*","*instrument*-orig-val__49489","fulcro.client.primitives/*instrument*","*parent*-orig-val__49490","fulcro.client.primitives/*parent*","*reconciler*-temp-val__49493","fulcro.client.primitives/get-reconciler","*depth*-temp-val__49494","fulcro.client.primitives/depth","*shared*-temp-val__49495","fulcro.client.primitives.shared.cljs$core$IFn$_invoke$arity$1","*instrument*-temp-val__49496","fulcro.client.primitives/instrument","*parent*-temp-val__49497","x49506","cljs.core/PROTOCOL_SENTINEL","x49519","this__43236__auto__","writer__43237__auto__","opt__43238__auto__","cljs.core/-write","_","params","fulcro.client.primitives/get-initial-state","fulcro.client.primitives.get_query.cljs$core$IFn$_invoke$arity$1","this","map__49502","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","root","fulcro.client.primitives/props","factory","fulcro.client.primitives.factory.cljs$core$IFn$_invoke$arity$1","js/com","js/com.wsscode","js/com.wsscode.pathom","js/com.wsscode.pathom.book","js/com.wsscode.pathom.book.app-types","js/com.wsscode.pathom.book.app-types.apps","com.wsscode.pathom.book.app-types/apps","cljs.core.atom.cljs$core$IFn$_invoke$arity$1","js/com.wsscode.pathom.book.app-types.app-types","com.wsscode.pathom.book.app-types/app-types","com.wsscode.pathom.book.app-types/register-app","name","f","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$4","cljs.core/assoc","com.wsscode.pathom.book.app-types/update-apps","seq__49528","cljs.core/seq","cljs.core/deref","chunk__49529","count__49530","i__49531","vec__49549","cljs.core.nth.cljs$core$IFn$_invoke$arity$3","map__49552","temp__5720__auto__","cljs.core/chunked-seq?","c__4550__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","vec__49554","cljs.core/first","map__49557","cljs.core/next","id","node","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$variadic","cljs.core/update-in","fulcro.client/mount","com.wsscode.pathom.book.app-types/mount-app","temp__5718__auto__","app-factory","map__49562","cljs.core/random-uuid","app","G__49563","or__4131__auto__","fulcro.client.new_fulcro_client.cljs$core$IFn$_invoke$arity$variadic","com.wsscode.pathom.core/parser","com.wsscode.pathom.map-db/parser-config","cljs.core.assoc.cljs$core$IFn$_invoke$arity$3","fulcro.client/mutate","fulcro-css.css-injection/upsert-css","js/console.warn"],"sourcesContent":["(ns com.wsscode.pathom.book.app-types\n  (:require [fulcro.client.primitives :as fp]\n            [fulcro.client :as fulcro]\n            [fulcro-css.css-protocols :as css]\n            [fulcro-css.css-injection :as css-injection]\n            [com.wsscode.pathom.core :as p]\n            [com.wsscode.pathom.map-db :as map-db]))\n\n(defn make-root [Root app-id]\n  (fp/ui\n    static fp/InitialAppState\n    (initial-state [_ params] {:fulcro.inspect.core/app-id app-id\n                               :ui/root (fp/get-initial-state Root params)})\n\n    static fp/IQuery\n    (query [_] [{:ui/root (fp/get-query Root)}])\n\n    static css/CSS\n    (local-rules [_] [])\n    (include-children [_] [Root])\n\n    Object\n    (render [this]\n      (let [{:ui/keys [root]} (fp/props this)\n            factory (fp/factory Root)]\n        (factory root)))))\n\n(defonce apps (atom {}))\n(defonce app-types (atom {}))\n\n(defn register-app [name f]\n  (swap! app-types assoc name f))\n\n(defn update-apps []\n  (doseq [[id {::keys [root node]}] @apps]\n    (swap! apps update-in [id ::app] fulcro/mount root node)\n    (.. node -classList (remove \"loader\"))))\n\n(defn mount-app [name node]\n  (if-let [app-factory (get @app-types name)]\n    (let [id  (random-uuid)\n          {::keys [root app]} (app-factory {::node node})\n          app (or app (fulcro/new-fulcro-client\n                        :parser\n                        (p/parser (-> map-db/parser-config\n                                      (assoc :mutate fulcro/mutate)))))]\n      (css-injection/upsert-css id {:component root})\n      (swap! apps assoc id {::app app ::root root ::node node}))\n    (js/console.warn \"App type\" name \"is not registered\")))\n"]}